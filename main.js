(()=>{"use strict";var e={434:(e,t,r)=>{e.exports=r.p+"images/landscape.c67e2c27cab8f7571845.svg"}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,r),c.exports}r.m=e,r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.p="",r.b=document.baseURI||self.location.href,(()=>{var e={adress:"https://nomoreparties.co/v1/plus-cohort-24",headers:{authorization:"237968ee-75dc-4a1c-917f-d4a72dcf6d28","Content-Type":"application/json"}};function t(e){return e.ok?e.json():Promise.reject("Что-то пошло не так: ".concat(e.status))}var n=Array.from(document.querySelectorAll(".popup")),o=document.querySelector("#popup-profile"),c=(o.querySelector("#first-name"),o.querySelector("#prof"),document.querySelector(".profile")),a=c.querySelector(".profile__avatar"),u=c.querySelector(".profile__name"),i=c.querySelector(".profile__about-me"),l=document.querySelector("#popup-avatar");function s(e){"Escape"===e.key&&n.forEach((function(e){e.classList.contains("popup_opened")&&_(e)}))}function d(e){e.target.classList.contains("popup_opened")&&_(e.target)}l.querySelector("#image");var f=new URL(r(434),r.b),p=document.querySelector("#popup-newCard").querySelector("#place"),m=document.querySelector("body");function v(){P(B(p.value,A.value,[],!1),!0)}function y(){var e=f;P(B(p.value,e,[],!1),!0)}function h(e){e.classList.add("popup_opened"),m.addEventListener("keydown",s),m.addEventListener("click",d)}function _(e){e.classList.remove("popup_opened"),m.removeEventListener("keydown",s),m.removeEventListener("click",d)}var S=["inputSelector","submitButtonSelector","inactiveButtonClass","activeButtonClass"];function b(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function q(e,t,r){e.disabled=!0,e.classList.add(t),e.classList.remove(r)}function g(e,t){var r=t.inputSelector,n=t.submitButtonSelector,o=t.inactiveButtonClass,c=t.activeButtonClass,a=b(t,S),u=Array.from(e.querySelectorAll(r)),i=e.querySelector(n);u.forEach((function(t){t.addEventListener("input",(function(){(function(e,t,r){var n=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(r),r));t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):(t.validity.tooShort,t.setCustomValidity("")),t.validity.valid?function(e,t,r){var n=r.inputSelectorError,o=e.querySelector(".".concat(t.id,"-span-error"));t.classList.remove(n),o.textContent=""}(e,t,n):function(e,t,r,n){var o=n.inputSelectorError,c=e.querySelector(".".concat(t.id,"-span-error"));t.classList.add(o),c.textContent=r}(e,t,t.validationMessage,n)})(e,t,a),function(e,t,r,n){var o,c,a;!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(c=r,a=n,(o=t).disabled=!1,o.classList.remove(c),o.classList.add(a)):q(t,r,n)}(u,i,o,c)}))}))}var C,E=document.querySelector(".photo-grid"),L=document.querySelector("#card").content.querySelector(".card-mesto"),x=document.querySelector("#popup-img"),k=x.querySelector(".popup__img"),O=x.querySelector(".popup__caption"),w=document.querySelector("#popup-newCard"),A=w.querySelector("#image"),j=w.querySelector(".button-submit");function B(r,n,o,c,a,u){var i=L.cloneNode(!0),l=i.querySelector(".card-mesto__desc-like"),s=i.querySelector(".card-mesto__trash"),d=i.querySelector(".card-mesto__img"),f=i.querySelector(".card-mesto__like-count");return i.querySelector(".card-mesto__desc-header").textContent=r,d.alt=r,d.src=n,f.textContent=o.length,u!==a&&(s.hidden=!0),o.forEach((function(e){e._id===a&&l.classList.add("card-mesto__desc-like_active")})),l.addEventListener("click",(function(r){var n;l.classList.contains("card-mesto__desc-like_active")?(n=c,fetch("".concat(e.adress,"/cards/likes/").concat(n),{method:"DELETE",headers:e.headers})).then((function(e){return t(e)})).then((function(e){var t=e.likes.length;f.textContent=t,r.target.classList.remove("card-mesto__desc-like_active")})).catch((function(e){console.log(e)})).finally((function(){})):function(t){return fetch("".concat(e.adress,"/cards/likes/").concat(t),{method:"PUT",headers:e.headers})}(c).then((function(e){return t(e)})).then((function(e){var t=e.likes.length;f.textContent=t,r.target.classList.add("card-mesto__desc-like_active")})).catch((function(e){console.log(e)})).finally((function(){}))})),s.addEventListener("click",(function(r){var n;(n=c,fetch("".concat(e.adress,"/cards/").concat(n),{method:"DELETE",headers:e.headers})).then((function(e){return t(e)})).then((function(e){i.remove()})).catch((function(e){console.log(e)})).finally((function(){}))})),d.addEventListener("click",(function(e){h(x),k.src=n,k.alt=r,O.textContent=r})),i}function P(e,t){!1===t?E.append(e):E.prepend(e)}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I,D,M,N=document.forms.card,U=(document.forms.profile,document.forms.avatar),J=document.querySelector(".profile"),H=J.querySelector(".profile__name"),R=J.querySelector(".profile__about-me"),V=document.querySelector("#popup-profile"),z=V.querySelector("#first-name"),$=V.querySelector("#prof"),F=document.querySelectorAll(".popup__close-icon"),G=(V.querySelector(".popup__close-icon"),V.querySelector(".button-submit")),K=document.querySelector("#popup-newCard"),Q=document.querySelector(".profile__edit-button"),W=document.querySelector(".profile__big-button"),X=(K.querySelector(".popup__close-icon"),K.querySelector(".button-submit")),Y=(document.querySelector("#popup-img").querySelector(".popup__close-icon"),document.querySelector("#popup-avatar")),Z=Y.querySelector(".button-submit"),ee=(Y.querySelector(".popup__close-icon"),J.querySelector(".profile__avatar")),te=(Y.querySelector("#image"),J.querySelector(".profile__name")),re=J.querySelector(".profile__about-me"),ne=J.querySelector(".profile__avatar");Promise.all([fetch("".concat(e.adress,"/users/me"),{headers:e.headers}).then((function(e){return t(e)})),fetch("".concat(e.adress,"/cards"),{headers:e.headers}).then((function(e){return t(e)}))]).then((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,c,a,u=[],i=!0,l=!1;try{if(c=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=c.call(r)).done)&&(u.push(n.value),u.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{if(!i&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,r)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],c=n[1];te.textContent=o.name,re.textContent=o.about,ne.src=o.avatar,C=o._id,c.forEach((function(e){P(B(e.name,e.link,e.likes,e._id,C,e.owner._id),!1)}))})).catch((function(e){console.log(e)})),V.addEventListener("submit",(function(r){r.preventDefault();var n,c=r.target.elements,a=c.name,l=c.about;r.submitter.textContent="Сохранение...",(n={name:a.value,about:l.value},fetch("".concat(e.adress,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:n.name,about:n.about})})).then((function(e){return t(e)})).then((function(e){u.textContent=a.value,i.textContent=l.value,_(o)})).finally((function(){r.submitter.textContent="Сохранить"}))})),K.addEventListener("submit",(function(r){r.preventDefault();var n,o=r.target.elements,c=o.image,a=o.name;r.submitter.textContent="Сохранение...",(n={image:c.value,name:a.value},fetch("".concat(e.adress,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:n.name,link:n.image})})).then((function(e){return t(e)})).then((function(e){var t,r,n,o;_(w),q(j),t=A.value,r=v,n=y,(o=new Image).src=t,o.onload=r,o.onerror=n})).catch((function(e){console.log(e)})).finally((function(){r.submitter.textContent="Сохранить"}))})),Y.addEventListener("submit",(function(r){r.preventDefault(),r.submitter.textContent="Сохранение...";var n,o=r.target.elements.avatar;(n={avatar:o.value},fetch("".concat(e.adress,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:n.avatar})})).then((function(e){return t(e)})).then((function(e){a.src=o.value,_(l)})).finally((function(){r.submitter.textContent="Сохранить"}))})),Q.addEventListener("click",(function(){q(G,"button-submit_inactive","button-submit_active"),z.value=H.textContent,$.value=R.textContent,h(V)})),W.addEventListener("click",(function(){q(X,"button-submit_inactive","button-submit_active"),X.textContent="Сохранить",N.reset(),h(K)})),ee.addEventListener("click",(function(){q(Z,"button-submit_inactive","button-submit_active"),U.reset(),h(Y)})),F.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return _(t)}))})),D=(I={formSelector:".popup__edit-value",inputSelector:".popup__input",inputSelectorError:"popup__input_error",submitButtonSelector:".button-submit",inactiveButtonClass:"button-submit_inactive",activeButtonClass:"button-submit_active"}).formSelector,M=b(I,["formSelector"]),Array.from(document.querySelectorAll(D)).forEach((function(e){g(e,M)}))})()})();