(()=>{"use strict";var e={434:(e,t,n)=>{e.exports=n.p+"images/landscape.c67e2c27cab8f7571845.svg"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,n),c.exports}n.m=e,n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href,(()=>{var e=Array.from(document.querySelectorAll(".popup")),t=document.querySelector("#popup-profile"),r=(t.querySelector("#first-name"),t.querySelector("#prof"),document.querySelector(".profile"));function o(t){"Escape"===t.key&&e.forEach((function(e){e.classList.contains("popup_opened")&&p(e)}))}function c(e){e.target.classList.contains("popup_opened")&&p(e.target)}r.querySelector(".profile__avatar"),r.querySelector(".profile__name"),r.querySelector(".profile__about-me"),document.querySelector("#popup-avatar").querySelector("#image");var a=new URL(n(434),n.b),u=document.querySelector("#popup-newCard").querySelector("#place"),i=document.querySelector("body");function s(){k(C(u.value,E.value,[],!1),!0)}function l(){var e=a;k(C(u.value,e,[],!1),!0)}function d(e){e.classList.add("popup_opened"),i.addEventListener("keydown",o),i.addEventListener("click",c)}function p(e){e.classList.remove("popup_opened"),i.removeEventListener("keydown",o),i.removeEventListener("click",c)}var f=["inputSelector","submitButtonSelector","inactiveButtonClass","activeButtonClass"];function m(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function v(e,t,n){e.disabled=!0,e.classList.add(t),e.classList.remove(n)}function y(e,t){var n=t.inputSelector,r=t.submitButtonSelector,o=t.inactiveButtonClass,c=t.activeButtonClass,a=m(t,f),u=Array.from(e.querySelectorAll(n)),i=e.querySelector(r);u.forEach((function(t){t.addEventListener("input",(function(){(function(e,t,n){var r=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(n),n));t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):(t.validity.tooShort,t.setCustomValidity("")),t.validity.valid?function(e,t,n){var r=n.inputSelectorError,o=e.querySelector(".".concat(t.id,"-span-error"));t.classList.remove(r),o.textContent=""}(e,t,r):function(e,t,n,r){var o=r.inputSelectorError,c=e.querySelector(".".concat(t.id,"-span-error"));t.classList.add(o),c.textContent=n}(e,t,t.validationMessage,r)})(e,t,a),function(e,t,n,r){var o,c,a;!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(c=n,a=r,(o=t).disabled=!1,o.classList.remove(c),o.classList.add(a)):v(t,n,r)}(u,i,o,c)}))}))}var _=document.querySelector(".photo-grid"),S=document.querySelector("#card").content.querySelector(".card-mesto"),h=document.querySelector("#popup-img"),b=h.querySelector(".popup__img"),q=h.querySelector(".popup__caption"),g=document.querySelector("#popup-newCard"),E=g.querySelector("#image"),L=g.querySelector(".button-submit");function C(e,t,n,r,o){var c=S.cloneNode(!0),a=c.querySelector(".card-mesto__desc-like"),u=c.querySelector(".card-mesto__trash"),i=c.querySelector(".card-mesto__img"),s=c.querySelector(".card-mesto__like-count");return c.querySelector(".card-mesto__desc-header").textContent=e,i.alt=e,i.src=t,s.textContent=n.length,n.forEach((function(e){e._id===j&&a.classList.add("card-mesto__desc-like_active")})),a.addEventListener("click",(function(e){var t;a.classList.contains("card-mesto__desc-like_active")?(t=r,fetch("".concat(B.adress,"/cards/likes/").concat(t),{method:"DELETE",headers:B.headers})).then((function(e){return T(e)})).then((function(t){var n=t.likes.length;s.textContent=n,e.target.classList.remove("card-mesto__desc-like_active")})).catch((function(){console.log("Что то не так c pbuttonLike.DELETE")})):function(e){return fetch("".concat(B.adress,"/cards/likes/").concat(e),{method:"PUT",headers:B.headers})}(r).then((function(e){return T(e)})).then((function(t){var n=t.likes.length;s.textContent=n,e.target.classList.add("card-mesto__desc-like_active")})).catch((function(){console.log("Что то не так c pbuttonLike.ADD")}))})),u.addEventListener("click",(function(e){var t;t=r,fetch("".concat(B.adress,"/cards/").concat(t),{method:"DELETE",headers:B.headers}),c.remove()})),i.addEventListener("click",(function(n){d(h),b.src=t,b.alt=e,q.textContent=e})),c}function k(e,t){!1===t?_.append(e):_.prepend(e)}var x=document.querySelector(".profile"),w=x.querySelector(".profile__name"),O=x.querySelector(".profile__about-me"),A=(document.querySelector("#popup-avatar").querySelector("#image"),x.querySelector(".profile__avatar")),j="462e4876dc9bbf55564f6ab8",B={adress:"https://nomoreparties.co/v1/plus-cohort-24",headers:{authorization:"237968ee-75dc-4a1c-917f-d4a72dcf6d28","Content-Type":"application/json"}};function T(e){return e.ok?e.json():Promise.reject("Что-то пошло не так: ".concat(e.status))}fetch("".concat(B.adress,"/users/me"),{headers:B.headers}).then((function(e){return T(e)})).then((function(e){w.textContent=e.name,O.textContent=e.about,A.src=e.avatar})).catch((function(){console.log("Что то не так c requestUser")})),fetch("".concat(B.adress,"/cards"),{headers:B.headers}).then((function(e){return T(e)})).then((function(e){e.forEach((function(e){var t=C(e.name,e.link,e.likes,e._id,e.owner);e.owner._id!==j&&(t.children[1].hidden=!0),k(t,!1)}))})).catch((function(){console.log("Что то не так c requestCards")}));var D,P,N,U=document.forms.card,I=(document.forms.profile,document.forms.avatar),J=document.querySelector(".profile"),M=J.querySelector(".profile__name"),H=J.querySelector(".profile__about-me"),R=document.querySelector("#popup-profile"),V=R.querySelector("#first-name"),z=R.querySelector("#prof"),F=R.querySelector(".popup__close-icon"),G=R.querySelector(".button-submit"),K=document.querySelector("#popup-newCard"),Q=document.querySelector(".profile__edit-button"),W=document.querySelector(".profile__big-button"),X=K.querySelector(".popup__close-icon"),Y=K.querySelector(".button-submit"),Z=document.querySelector("#popup-img"),$=Z.querySelector(".popup__close-icon"),ee=document.querySelector("#popup-avatar"),te=ee.querySelector(".button-submit"),ne=ee.querySelector(".popup__close-icon"),re=J.querySelector(".profile__avatar");ee.querySelector("#image"),R.addEventListener("submit",(function(e){e.preventDefault();var t,n=e.target.elements,r=n.name,o=n.about;e.submitter.textContent="Сохранение...",function(e){return fetch("".concat(B.adress,"/users/me"),{method:"PATCH",headers:B.headers,body:JSON.stringify({name:e.name,about:e.about})})}(t={name:r.value,about:o.value}).then((function(e){return T(e)})).then((function(e){w.textContent=t.name,O.textContent=t.about})).catch((function(){console.log("Что то не так c updateUserName".concat(t))}))})),K.addEventListener("submit",(function(e){e.preventDefault();var t,n,r,o,c,a=e.target.elements,u=a.image,i=a.name;e.submitter.textContent="Сохранение...",function(e){return fetch("".concat(B.adress,"/cards"),{method:"POST",headers:B.headers,body:JSON.stringify({name:e.name,link:e.image})})}(t={image:u.value,name:i.value}).then((function(e){return T(e)})).then((function(e){})).catch((function(){console.log("Что то не так c postNewCard".concat(t))})),p(g),v(L),n=E.value,r=s,o=l,(c=new Image).src=n,c.onload=r,c.onerror=o})),ee.addEventListener("submit",(function(e){e.preventDefault(),e.submitter.textContent="Сохранение...";var t,n=e.target.elements.avatar;(function(e){return fetch("".concat(B.adress,"/users/me/avatar"),{method:"PATCH",headers:B.headers,body:JSON.stringify({avatar:e.avatar})})})(t={avatar:n.value}).then((function(e){return T(e)})).then((function(e){A.src=t.avatar})).catch((function(){console.log("Что то не так c updateAvatar".concat(t))}))})),Q.addEventListener("click",(function(){v(G,"button-submit_inactive","button-submit_active"),G.textContent="Сохранить",V.value=M.textContent,z.value=H.textContent,d(R)})),F.addEventListener("click",(function(){p(R)})),G.addEventListener("click",(function(){""==!V.value&&""==!z.value&&p(R)})),W.addEventListener("click",(function(){v(Y,"button-submit_inactive","button-submit_active"),Y.textContent="Сохранить",U.reset(),d(K)})),X.addEventListener("click",(function(){U.reset(),p(K)})),$.addEventListener("click",(function(){p(Z)})),re.addEventListener("click",(function(){v(te,"button-submit_inactive","button-submit_active"),I.reset(),te.textContent="Сохранить",d(ee)})),te.addEventListener("click",(function(){p(ee)})),ne.addEventListener("click",(function(){p(ee)})),P=(D={formSelector:".popup__edit-value",inputSelector:".popup__input",inputSelectorError:"popup__input_error",submitButtonSelector:".button-submit",inactiveButtonClass:"button-submit_inactive",activeButtonClass:"button-submit_active"}).formSelector,N=m(D,["formSelector"]),Array.from(document.querySelectorAll(P)).forEach((function(e){y(e,N)}))})()})();